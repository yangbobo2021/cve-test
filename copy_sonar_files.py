import os
import json
import shutil

def copy_case_files(source_dir, dest_dir):
    if not os.path.exists(dest_dir):
        os.makedirs(dest_dir)
    
    for root, _, files in os.walk(source_dir):
        for file in files:
            src_file = os.path.join(root, file)
            rel_path = os.path.relpath(src_file, source_dir)
            dest_file = os.path.join(dest_dir, rel_path)
            
            os.makedirs(os.path.dirname(dest_file), exist_ok=True)
            shutil.copy2(src_file, dest_file)

def main():
    with open('small_file_cases.json', 'r') as f:
        cases = json.load(f)

    for case in cases:
        source_dir = case
        dest_dir = os.path.join('sonar', os.path.basename(case))
        
        try:
            copy_case_files(source_dir, dest_dir)
            print(f"Files copied from {source_dir} to {dest_dir}")
        except Exception as e:
            print(f"Error copying files for case {case}: {str(e)}")

if __name__ == "__main__":
    main()