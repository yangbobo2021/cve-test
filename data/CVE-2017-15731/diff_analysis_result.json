{
    "before_functions": "if ($user->perm->checkRight($user->getUserId(), 'adminlog') && 'adminlog' == $action) {\n    $date = new PMF_Date($faqConfig);\n    $perpage = 15;\n    $pages = PMF_Filter::filterInput(INPUT_GET, 'pages', FILTER_VALIDATE_INT);\n    $page = PMF_Filter::filterInput(INPUT_GET, 'page', FILTER_VALIDATE_INT, 1);\n\n    if (is_null($pages)) {\n        $pages = round(($logging->getNumberOfEntries() + ($perpage / 3)) / $perpage, 0);\n    }\n\n    $start = ($page - 1) * $perpage;\n    $ende = $start + $perpage;\n\n    $baseUrl = sprintf(\n        '%s?action=adminlog&amp;page=%d',\n        PMF_Link::getSystemRelativeUri(),\n        $page\n    );\n\n    // Pagination options\n    $options = array(\n        'baseUrl' => $baseUrl,\n        'total' => $logging->getNumberOfEntries(),\n        'perPage' => $perpage,\n        'pageParamName' => 'page',\n    );\n    $pagination = new PMF_Pagination($faqConfig, $options);\n\n    $loggingData = $logging->getAll();\n    ?>\n    <header class=\"row\">\n        <div class=\"col-lg-12\">\n            <h2 class=\"page-header\">\n                <i aria-hidden=\"true\" class=\"fa fa-tasks\"></i> <?php echo $PMF_LANG['ad_menu_adminlog'];\n    ?>\n                <div class=\"pull-right\">\n                    <a class=\"btn btn-danger\" href=\"?action=deleteadminlog\">\n                        <i aria-hidden=\"true\" class=\"fa fa-trash\"></i> <?php echo $PMF_LANG['ad_adminlog_del_older_30d'] ?>\n                    </a>\n                </div>\n            </h2>\n        </div>\n    </header>\n\n    // ... (rest of the HTML and PHP code)\n\n} elseif ($user->perm->checkRight($user->getUserId(), 'adminlog') && 'deleteadminlog' == $action) {\n    if ($logging->delete()) {\n        printf('<p class=\"alert alert-success\">%s</p>', $PMF_LANG['ad_adminlog_delete_success']);\n    } else {\n        printf('<p class=\"alert alert-danger\">%s</p>', $PMF_LANG['ad_adminlog_delete_failure']);\n    }\n} else {\n    echo $PMF_LANG['err_NotAuth'];\n}\n",
    "after_functions": "if ($user->perm->checkRight($user->getUserId(), 'adminlog') && 'adminlog' == $action) {\n    $date = new PMF_Date($faqConfig);\n    $perpage = 15;\n    $pages = PMF_Filter::filterInput(INPUT_GET, 'pages', FILTER_VALIDATE_INT);\n    $page = PMF_Filter::filterInput(INPUT_GET, 'page', FILTER_VALIDATE_INT, 1);\n    $csrfToken = PMF_Filter::filterInput(INPUT_GET, 'csrf', FILTER_SANITIZE_STRING);\n\n    if (is_null($pages)) {\n        $pages = round(($logging->getNumberOfEntries() + ($perpage / 3)) / $perpage, 0);\n    }\n\n    if (!isset($_SESSION['phpmyfaq_csrf_token']) || $_SESSION['phpmyfaq_csrf_token'] !== $csrfToken) {\n        $deleteLog = false;\n    } else {\n        $deleteLog = true;\n    }\n\n    $start = ($page - 1) * $perpage;\n    $ende = $start + $perpage;\n\n    $baseUrl = sprintf(\n        '%s?action=adminlog&amp;page=%d',\n        PMF_Link::getSystemRelativeUri(),\n        $page\n    );\n\n    // Pagination options\n    $options = array(\n        'baseUrl' => $baseUrl,\n        'total' => $logging->getNumberOfEntries(),\n        'perPage' => $perpage,\n        'pageParamName' => 'page',\n    );\n    $pagination = new PMF_Pagination($faqConfig, $options);\n\n    $loggingData = $logging->getAll();\n    ?>\n    <header class=\"row\">\n        <div class=\"col-lg-12\">\n            <h2 class=\"page-header\">\n                <i aria-hidden=\"true\" class=\"fa fa-tasks\"></i> <?php echo $PMF_LANG['ad_menu_adminlog'];\n    ?>\n                <div class=\"pull-right\">\n                    <a class=\"btn btn-danger\"\n                       href=\"?action=deleteadminlog&csrf=<?php echo $user->getCsrfTokenFromSession() ?>\">\n                        <i aria-hidden=\"true\" class=\"fa fa-trash\"></i> <?php echo $PMF_LANG['ad_adminlog_del_older_30d'] ?>\n                    </a>\n                </div>\n            </h2>\n        </div>\n    </header>\n\n    // ... (rest of the HTML and PHP code)\n\n} elseif ($user->perm->checkRight($user->getUserId(), 'adminlog') && 'deleteadminlog' == $action && $deleteLog) {\n    if ($logging->delete()) {\n        printf('<p class=\"alert alert-success\">%s</p>', $PMF_LANG['ad_adminlog_delete_success']);\n    } else {\n        printf('<p class=\"alert alert-danger\">%s</p>', $PMF_LANG['ad_adminlog_delete_failure']);\n    }\n} else {\n    echo $PMF_LANG['err_NotAuth'];\n}\n"
}