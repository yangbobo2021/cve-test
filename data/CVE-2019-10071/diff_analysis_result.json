{
    "before_functions": "private void validateHMAC(String storedHmacResult, Base64InputStream b64in) throws IOException\n{\n    MacOutputStream macOs = MacOutputStream.streamFor(hmacKey);\n\n    TapestryInternalUtils.copy(b64in, macOs);\n\n    macOs.close();\n\n    String actual = macOs.getResult();\n\n    if (!storedHmacResult.equals(actual))\n    {\n        throw new IOException(\"Client data associated with the current request appears to have been tampered with \" +\n                \"(the HMAC signature does not match).\");\n    }\n}\n",
    "after_functions": "private void validateHMAC(String storedHmacResult, Base64InputStream b64in) throws IOException\n{\n    MacOutputStream macOs = MacOutputStream.streamFor(hmacKey);\n\n    TapestryInternalUtils.copy(b64in, macOs);\n\n    macOs.close();\n\n    String actual = macOs.getResult();\n\n    if (!MessageDigest.isEqual(storedHmacResult.getBytes(), actual.getBytes()))\n    {\n        throw new IOException(\"Client data associated with the current request appears to have been tampered with \" +\n                \"(the HMAC signature does not match).\");\n    }\n}\n"
}