{
    "before_functions": "if (!isset($_SESSION['phpmyfaq_csrf_token']) || $_SESSION['phpmyfaq_csrf_token'] !== $csrfToken) {\n    $statdelete = null;\n}\n\n// Reset all visits and sessions\nif ('clear-visits' === $action) {\n\n    // Clear visits\n    $visits->resetAll();\n\n    // Delete logifles\n    $files = glob(PMF_ROOT_DIR.'/data/*');\n    foreach ($files as $file) {\n        if (is_file($file)) {\n            unlink($file);\n        }\n    }\n\n    // Delete sessions\n    $session->deleteAllSessions();\n\n    printf('<p class=\"alert alert-success\">%s</p>', $PMF_LANG['ad_reset_visits_success']);\n}\n",
    "after_functions": "if (!isset($_SESSION['phpmyfaq_csrf_token']) || $_SESSION['phpmyfaq_csrf_token'] !== $csrfTokenFromPost) {\n    $statdelete = null;\n}\n\nif (!isset($_SESSION['phpmyfaq_csrf_token']) || $_SESSION['phpmyfaq_csrf_token'] !== $csrfTokenFromGet) {\n    $clearVisits = false;\n} else {\n    $clearVisits = true;\n}\n\n// Reset all visits and sessions\nif ('clear-visits' === $action && $clearVisits) {\n\n    // Clear visits\n    $visits->resetAll();\n\n    // Delete logifles\n    $files = glob(PMF_ROOT_DIR.'/data/*');\n    foreach ($files as $file) {\n        if (is_file($file)) {\n            unlink($file);\n        }\n    }\n\n    // Delete sessions\n    $session->deleteAllSessions();\n\n    printf('<p class=\"alert alert-success\">%s</p>', $PMF_LANG['ad_reset_visits_success']);\n}\n"
}