{
    "before_functions": "else if ($action == 'updateform')\n{\n\t$res3=dolibarr_set_const($db, 'MAIN_UPLOAD_DOC',GETPOST('MAIN_UPLOAD_DOC','alpha'),'chaine',0,'',$conf->entity);\n\t$res4=dolibarr_set_const($db, \"MAIN_UMASK\", GETPOST('MAIN_UMASK','alpha'),'chaine',0,'',$conf->entity);\n\t$res5=dolibarr_set_const($db, \"MAIN_ANTIVIRUS_COMMAND\", trim(GETPOST('MAIN_ANTIVIRUS_COMMAND','none')),'chaine',0,'',$conf->entity);    // Use GETPOST none because we must accept \"\n\t$res6=dolibarr_set_const($db, \"MAIN_ANTIVIRUS_PARAM\", trim(GETPOST('MAIN_ANTIVIRUS_PARAM','none')),'chaine',0,'',$conf->entity);\t// Use GETPOST none because we must accept \"\n\tif ($res3 && $res4 && $res5 && $res6) setEventMessages($langs->trans(\"RecordModifiedSuccessfully\"), null, 'mesgs');\n}\n",
    "after_functions": "else if ($action == 'updateform')\n{\n\t$antivircommand = GETPOST('MAIN_ANTIVIRUS_COMMAND','none');\t\t\t// Use GETPOST none because we must accept \". Example c:\\Progra~1\\ClamWin\\bin\\clamscan.exe\n\t$antivirparam = GETPOST('MAIN_ANTIVIRUS_PARAM','none');\t\t\t\t// Use GETPOST none because we must accept \". Example --database=\"C:\\Program Files (x86)\\ClamWin\\lib\"\n\t$antivircommand = dol_string_nospecial($antivircommand, '', array(\"|\", \";\", \"<\", \">\", \"&\"));\t// Sanitize command\n\t$antivirparam = dol_string_nospecial($antivirparam, '', array(\"|\", \";\", \"<\", \">\", \"&\"));\t\t// Sanitize params\n\n\t$res3=dolibarr_set_const($db, 'MAIN_UPLOAD_DOC',GETPOST('MAIN_UPLOAD_DOC','alpha'),'chaine',0,'',$conf->entity);\n\t$res4=dolibarr_set_const($db, \"MAIN_UMASK\", GETPOST('MAIN_UMASK','alpha'),'chaine',0,'',$conf->entity);\n\t$res5=dolibarr_set_const($db, \"MAIN_ANTIVIRUS_COMMAND\", trim($antivircommand),'chaine',0,'',$conf->entity);\n\t$res6=dolibarr_set_const($db, \"MAIN_ANTIVIRUS_PARAM\", trim($antivirparam),'chaine',0,'',$conf->entity);\n\tif ($res3 && $res4 && $res5 && $res6) setEventMessages($langs->trans(\"RecordModifiedSuccessfully\"), null, 'mesgs');\n}\n"
}