{
    "before_functions": "public void initialize() throws InitializationException {\n    \n    log.info(\"Initializing Roller Weblogger business tier\");\n    \n    // TODO: this should probably be done in a more uniform fashion, possibly\n    // using annotations?  biggest issue is controlling ordering\n    getPropertiesManager().initialize();\n    getThemeManager().initialize();\n    getThreadManager().initialize();\n    getIndexManager().initialize();\n    getMediaFileManager().initialize();\n    \n    try {\n        // Initialize ping systems\n        // TODO: this should probably be moving inside ping manager initialize() methods?\n        \n        // Initialize common targets from the configuration\n        PingConfig.initializeCommonTargets();\n        \n        // Initialize ping variants\n        PingConfig.initializePingVariants();\n        \n        // Remove all autoping configurations if ping usage has been disabled.\n        if (PingConfig.getDisablePingUsage()) {\n            log.info(\"Ping usage has been disabled.  Removing any existing auto ping configurations.\");\n            WebloggerFactory.getWeblogger().getAutopingManager().removeAllAutoPings();\n        }\n    } catch (Exception e) {\n        throw new InitializationException(\"Error initializing ping systems\", e);\n    }\n    \n    // we always need to do a flush after initialization because it's\n    // possible that some changes need to be persisted\n    try {\n        flush();\n    } catch(WebloggerException ex) {\n        throw new InitializationException(\"Error flushing after initialization\", ex);\n    } \n    \n    log.info(\"Roller Weblogger business tier successfully initialized\");\n}\n",
    "after_functions": "public void initialize() throws InitializationException {\n    \n    log.info(\"Initializing Roller Weblogger business tier\");\n    \n    // TODO: this should probably be done in a more uniform fashion, possibly\n    // using annotations?  biggest issue is controlling ordering\n    getPropertiesManager().initialize();\n    getThemeManager().initialize();\n    getThreadManager().initialize();\n    getIndexManager().initialize();\n    getMediaFileManager().initialize();\n\n    // Turn off External DTD support in SAXParser to protect Roller from vulnerability.\n    SAXParserFactory spf = SAXParsers.getSAXParserFactory();\n    try {\n        spf.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n        spf.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);\n    } catch (ParserConfigurationException | SAXNotRecognizedException | SAXNotSupportedException e) {\n        String message = \"Unable to turn off External DTD support in SAXParser. XML-RLC is vulnerable\";\n        if ( log.isDebugEnabled() ) {\n            log.error(message, e);\n        } else {\n            log.error(message);\n        }\n    }\n\n    try {\n        // Initialize ping systems\n        // TODO: this should probably be moving inside ping manager initialize() methods?\n        \n        // Initialize common targets from the configuration\n        PingConfig.initializeCommonTargets();\n        \n        // Initialize ping variants\n        PingConfig.initializePingVariants();\n        \n        // Remove all autoping configurations if ping usage has been disabled.\n        if (PingConfig.getDisablePingUsage()) {\n            log.info(\"Ping usage has been disabled.  Removing any existing auto ping configurations.\");\n            WebloggerFactory.getWeblogger().getAutopingManager().removeAllAutoPings();\n        }\n    } catch (Exception e) {\n        throw new InitializationException(\"Error initializing ping systems\", e);\n    }\n    \n    // we always need to do a flush after initialization because it's\n    // possible that some changes need to be persisted\n    try {\n        flush();\n    } catch(WebloggerException ex) {\n        throw new InitializationException(\"Error flushing after initialization\", ex);\n    } \n    \n    log.info(\"Roller Weblogger business tier successfully initialized\");\n}\n"
}